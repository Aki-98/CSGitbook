# 磁盘

磁盘上的盘片被细分为多个大小相同的扇区，扇区是磁盘空间的基本单位，一般来说，一个扇区的大小为512字节。

磁盘中的第一个扇区非常重要，其中存储了与磁盘正常使用相关的重要信息：主引导记录、磁盘分区表、魔数。

- **主引导记录**（Master Boot Record）占用446字节，其中包含一段被称为引导加载流程（Boot Loader）的程序，计算机启动后，会到磁盘0扇面的0扇区去读取MBR中的内容，只有MBR中的程序正确无误，计算机才能正常开机。
- **磁盘分区表**（Partition Table）占用64个字节，其中记录整块磁盘的分区状态，每个分区的信息需要16个字节，因此磁盘分区表若只记录分区信息，便最多只能存储4个分区的分区信息。
- **魔数**（Magic Number）占用2个字节，用来标识MBR是否有效。

Linux系统中遵循“一切皆文件”的思想，Linux下的设备也会被视为文件，硬盘作为设备的一种，其对应的文件被存储于系统的/dev目录下。若磁盘为SATA类型，则磁盘路径名为/dev/sda，如图所示的四个分区（主分区）在/dev目录下对应的文件名如下所示：

- P1: /dev/sda1
- P2: /dev/sda2
- P3: /dev/sda3
- P4: /dev/sda4

总共有4个分区显然是不够的，所以设计了扩展分区的概念，扩展分区和主分区一样，也是存放在64B的分区表中，也就是它会占一个主分区号，它的作用是用来扩展成多个其他分区的，扩展分区本身不可以直接使用，可以在扩展分区上建立逻辑分区，这时逻辑分区是可以设置很多个的，所以说其实扩展分区是一种用来解决分区表只能有4个分区限制的问题。

- 主分区数量至少1个，最多4个(如果存在扩展分区，则最多3个）。主分区可以直接使用，主分区本身不能继续分区，一个主分区就是一个逻辑磁盘。
- 扩展分区0个或1个，会占用一个主分区号，不能直接使用，必须在其上建立逻辑分区后才能用。 其实就是把1个主分区拿过来进行分区扩展了。
- 逻辑分区可以若干个，通过扩展分区建立，可以直接使用，扩展分区的容量是所有逻辑分区容量之和（如果扩展分区被完全使用的话）。

![image-20230410152149875](Linux - 文件系统（原理&命令&编程）_imgs\image-20230410152149875.png)

P1为主分区，P2为扩展分区，占用了一个主分区号。

L1-L4为逻辑分区。

# 系统目录结构

![image-20230403170006451](Linux - 文件系统（原理&命令&编程）_imgs\image-20230403170006451.png)

以下是对这些目录的解释：

| 目录           | 使用                                                         |
| -------------- | ------------------------------------------------------------ |
| /              | 根目录，只包含目录，不包含文件                               |
| /bin           | 存放可执行文件，bin是Binary的缩写，常用命令都以二进制文件的形式存放在该目录中 |
| /boot          | 这里存放的是启动Linux时使用的一些核心文件，包适一些连接文件以及镜像文件、内核文件、引导程序文件等 |
| /dev           | dev是device的缩写，该目录下存放的是Linux的外部设备，在Linux中访问设备的方式和访问文件的方式是相同的。包括块设备文件（如磁盘对应文件）、字符设备文件（如键盘对应文件）等。 |
| /etc           | 这个目录用来存放所有的系统管理所需要的配置文件和子目录       |
| /home          | 用户的主目录，在Linux中。每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的， |
| /lib           | 这个目录里存放着系统最基本的动态连接共享库。其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用这些共享库。该目录中的文件一般以.a、.dll、.so结尾（后缀不代表文件类型）。也会存放与内核模块相关的文件。 |
| /lost+found    | 这个目录一般情况下是空的。当系统非法关机后。这里就存放了一些文件· |
| /media         | linux系统会自动识别一些设备，例如U盘、光驱等等，当识别后，Linux会把识别的设备挂载到这个目录下 |
| /mnt           | 系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱内容了。 |
| /opt           | 存放附加的应用程序软件包                                     |
| /proc          | 这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。<br/>这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件，比如可以通过下面的命令来屏蔽主机的ping命令，使别人无法ping你的机器：<br/>echo 1 > /proc/sys/net/ipv4/icmp_echo_ignore_all |
| /root          | 该目录为系统管理员，也称作超级权限者的用户主目录             |
| /sbin          | s就是SuperUser的意思，这里存放的是系统管理员使用的系统管理程序 |
| /selinux       | 这个目录是Redhat/CentOS所特有的目录，SeLinux是一个安全机制，类似于Windows的防火墙，但是这套机制比较复杂，目录就是存放SeLinux相关的文件的。 |
| /srv           | 该目录存放一些服务启动之后需要提取的数据                     |
| /sys           | 这是Linux2.6内核的一个很大变化，该目录下安装了2.6内核中一个新出现的文件系统sysfs。<br/>sysfs文件系统集成了下面三种文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统、针对伪终端的devpts文件系统。<br/>该文件系统是内核设备的一个直观反映<br/>当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建 |
| /swap          | 存放虚拟内存交换所用文件                                     |
| /tmp           | 这个目录是用来存放一些临时文件的，重启系统后该目录的文件不会被保存，每个用户都能创建该目录，但不能删除其它用户的/tmp目录 |
| /usr           | 这是一个非常重要的目录，用户的很多应用程序和文件从放在这个目录下，类似于windows下的program files目录，占用空间最大的目录 |
| /usr/bin       | 系统用户使用的应用程序                                       |
| /usr/sbin      | 超级用户使用的比较高级的管理程序和系统守护程序               |
| /usr/lib       | 库文件                                                       |
| /usr/src       | 内核源代码默认的放置目录                                     |
| /usr/share/doc | 文档                                                         |
| /var           | 这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下，包括各种日志文件。 |
| /run           | 是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删除或清除。如果你的系统上有/var/run目录，应该让它指向run。<br/> |

比较重要的目录，注意不要误删或随意修改内部文件：

- /etc
  - 配置文件存放目录，修改可能导致系统不能启动
- /bin、/sbin、/usr/bin、/usr/sbin
  - 系统预设执行文件的存放目录
- /var
  - 各个程序的日志文件，mail的预设等

# 文件类型

Linux系统中的文件类型不以扩展名区分，拓展名只表示与程序的关联。

ls -l 命令打印的文件属性信息中的第一个字符，便代表文件的类型：

- d：directory，目录文件
- l：link，符号链接文件
- s：socket，嵌套字文件
- b：block，块设备文件
- c：character，字符设备文件
- p：pile，管道文件
- -：不属于以上任一种文件的普通文件

## 设备文件

Linux系统中将外部设备视为一个文件来管理，设备文件被保存在系统的/dev目录下。

将设备抽象为文件的好处是：应用程序可以使用与操作普通文件一样的方式，对设备文件执行打开、关闭、读写等操作。

比如查看属性信息时，无论是普通文件还是设备，都可以使用”ls -l"命令。

使用"ls -l /dev"命令查看设备文件的详细信息

## 硬链接与软链接（符号链接）

链接文件分为两种：硬链接文件和软链接文件，这两种文件都能实现windows中快捷方式的功能，但它们的实现方式不同。

### 硬链接

硬链接是指通过索引节点来进行链接。在Linux的文件系统中，保存在磁盘分区中的文件不管是什么类型都会给它分配一个编号，这个编号被称为索引节点编号号(Inode)，它是文件或者目录在一个文件系统中的唯一标识，文件的实际数据放置在数据区域（data block），它存储着文件重要参数信息，也就是元数据 （metadata），比如创建时间、修改时间、文件大小、属主、归属的用户组、读写权限、数据所在block号等，如下图所示。



在Linux系统中，多个文件名指向同一索引节点(Inode)是正常且允许的。一般这种链接就称为硬链接。硬链接的作用之一是允许一个文件拥有多个有效路径名，这样用户就可以建立硬链接到重要的文件，以防止“误删”源数据(很多硬件，如netapp存储中的快照功能就应用了这个原理，增加一个快照就多了一个硬链接》。不过硬链接只能在同一文件系统中的文件之间进行链接，不能对目录进行创建。之所以文件建立了硬链接就会防止数据误删，是因为文件系统的原理是，只要文件的索引节点还有一个以上的链接（仅删除了该文件的指向），只删除其中一个链接并不影响索引节点本身和其他的链接（数据的实体并未删除），只有当最后一个链接被删除后，此时如果有新数据要存储到磁盘上，被删除的文件的数据块及目录的链接才会被释放，空间被新数据暂用覆盖。

### 软链接

软链接（也叫符号链接），类似于windows系统中的快捷方式，与硬链接不同，软链接就是一个普通文件，只是数据块内容有点特殊，文件用户数据块中存放的内容是另一文件的路径名的指向，通过这个方式可以快速定位到软连接所指向的源文件实体。软链接可对文件或目录创建。

软链接作用：

- 便于文件的管理，比如把一个复杂路径下的文件链接到一个简单路径下方便用户访问。
- 节省空间解决空间不足问题，某个文件文件系统空间已经用完了，但是现在必须在该文件系统下创建一个新的目录并存储大量的文件，那么可以把另一个剩余空间较多的文件系统中的目录链接到该文件系统中。

删除软链接并不影响被指向的文件，但若被指向的原文件被删除，则相关软连接就变成了死链接。

### 区别

软链接：

1. 软链接是存放另一个文件的路径的形式存在。
2. 软链接可以 跨文件系统 ，硬链接不可以。
3. 软链接可以对一个不存在的文件名进行链接，硬链接必须要有源文件。
4. 软链接可以对目录进行链接。

硬链接：

1. 硬链接，以文件副本的形式存在。但不占用实际空间。
2. 不允许给目录创建硬链接。
3. 硬链接只有在同一个文件系统中才能创建。
4. 删除其中一个硬链接文件并不影响其他有相同 inode 号的文件。

**不论是硬链接或软链接都不会将原本的档案复制一份，只会占用非常少量的磁碟空间。**

## 文件描述符（File Descriptor)

![image-20230411150929807](Linux - 文件系统（原理&命令&编程）_imgs\image-20230411150929807.png)

文件描述符是一个非负整数，实质上是一个索引值，存储于由内核维护的该进程打开的文件描述符表中。

系统为每个进程维护了一个**文件描述符表**（open file description table)，用于存储进程打开文件的文件描述符，进程打开的普通文件其文件描述符从3开始。

存在于进程中的文件描述符是进程级别的，除此之外，内核也对所有打开的文件维护了一个文件描述符表，这是一个系统级的文件描述符表，该表又称**打开文件表**（open file table），表中的记录被称为**打开文件句柄**（open file handle）

一个打开文件句柄中与一个已打开的文件相关的信息如下：

- 当前文件的偏移量
- 打开文件时所用的状态标识
- 文件访问模式
- 与信号驱动相关的设置
- 对该文件inode对象的引用
- 文件类型和访问权限
- 指向该文件所持有的锁列表的指针
- 文件的各种属性信息

# 文件系统

## inode与dentry

Linux系统中将文件的属性与数据分开存储，文件中的数据存放的区域称为数据区，文件属性又被称为元数据，存放文件属性的区域称为元数据区，基于这种文件存储方式，Linux文件系统中定义了两个与文件相关的，至关重要的概念：索引节点和目录项：

- **索引结点（inode）**
  - 实质是一个结构体，主要功能是保存文件的属性信息（如所有者、所属区、权限、文件大小、时间戳等）。
  - Linux系统中每个文件都会被分配一个inode，当由文件创建时，系统会在inode表中获取一个空闲的inode分配给这个文件。inode存储在inode表中，inode表存储inode和incode的编号（inumber），inode表在文件系统创建之时便被创建，因此文件系统中可存储的文件数量也在文件系统创建时已确定。
- **目录项（dentry）**
  - Linux文件系统中的索引结点保存着文件的诸多属性信息，但并未保存文件的文件名。实际上，Linux系统中文件的文件名并不保存在文件中，而是保存在存放该文件的目录中。
  - Linux系统中定义了一个被称为目录项的结构体，该结构体主要存储文件的文件名与inode编号，系统通过读取目录项中的文件名和文件的inumber，来判断文件是否存在于这个目录中。dentry允许同一个inode对应不同的文件名，但不允许相同的文件名对应不同的inode。

## ext2与ext3文件系统

### ext2

![image-20230410161310469](Linux - 文件系统（原理&命令&编程）_imgs\image-20230410161310469.png)

磁盘分区的第一个部分为启动块（Boot Block），启动块占用一个块空间，用来存储磁盘的分区信息和启动信息。图中启动块后是多个块组，每个块组包含六部分：超级块（SuperBlock）、块组描述符（GDT）、块位图（Block Bitmap）、位图（Inode Bitmap）、位表（Inode Table）、数据块（Data Blocks）

ext2文件系统的结构有以下几个优点：

- 可有效放置磁盘碎片的产生，减少磁盘传送次数，降低系统消耗
- 管理员可以根据给定分区的大小，预计分区中存放的文件数，从而确定分区中inode的数量，保证磁盘空间利用率
- 降低对存放一个单独块组中的文件并行访问时磁盘的平均寻道时间
- 支持快速符号链接

### ext3

ext3是一个完全兼容ext2文件系统的日志文件系统，它在ext2的基础上，添加了一个被称为日志的块，专门记录写入或修订文件时的步骤

日志文件系统可以按照不同的方式进行工作。ext3中可通过对/etc/fstab文件中的data属性进行设置来修改文件系统的工作模式。日志文件系统的工作模式分为三种，其设置方式如下：

- data=journal
- data=ordered
- data=writeback

## 数据块寻址

![image-20230410162038504](Linux - 文件系统（原理&命令&编程）_imgs\image-20230410162038504.png)

Linux文件系统中文件的属性信息和数据分开存放，系统通过文件inode中的索引项Block来查找文件数据。Block索引项是一个数组，包括15个索引项，其中：

- Block[0]-Block[11] 直接索引项
- Block[12] 间接索引项
- Block[13] 二级间接索引项
- Block[14] 三级间接索引项

## 虚拟文件系统

![image-20230410165803916](Linux - 文件系统（原理&命令&编程）_imgs\image-20230410165803916.png)

虚拟文件系统又称虚拟文件切换系统（Virtual Filesystem Switch），是操作系统中文件系统的虚拟层，其下才是具体的文件系统。虚拟文件系统的主要功能，是实现多种文件系统操作接口的统一，既能让上层的调用者使用同一套接口与底层的各种文件系统交互，又能对文件系统提供一个标准接口，使Linux系统能同时支持多种文件系统。虚拟文件系统与上层应用以及底层的各种文件系统之间的关系如上图。

## 挂载

挂载是指将一个目录作为入口，将磁盘分区中的数据放置在以该目录为根节点的目录关系树当中，这相当于为文件系统与磁盘进行了链接，制定了某个分区中文件系统访问的位置。

Linux系统中根目录是整个磁盘访问的基点，因此根目录必须要挂载到某个分区。

# 命令

## 磁盘操作

### fdisk 用于磁盘分区

作用：查看当前系统中的磁盘，磁盘中的分区情况，也可用于磁盘分区

语法：

```
fdisk [-l] <装置名称>
```

选项：

-l 可以列出指定设备的分区表状态，若仅有fdisk -l时，则系统将会把整个系统内能够搜寻到的装置的分区均列出来。

例：列出所有分区信息

![image-20230413160505466](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413160505466.png)

例：找出系统中的根目录所在磁盘，并查阅该硬盘内的相关信息

![image-20230413160622317](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413160622317.png)

输入m后，就会看到底下这些命令介绍

![image-20230413160648576](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413160648576.png)

离开fdisk时按下q，那么所有的动作都不会生效，相反的按下w就是动作生效的意思。

![image-20230413160739724](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413160739724.png)

使用p可以列出目前这颗磁盘的分割表信息，这个信息的上半部在显示整体磁盘的状态。

### fsck 检查和维护不一致的文件系统

若系统掉电或磁盘发生问题，可利用fsck命令对文件系统进行检查。

语法：

```
fsck [-t 文件系统] [-ACay] 装置名称
```

选项：

| 选项 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| -t   | 给定档案系统的型式，若在/etc/fstab中已有定义或kernel本身已支援的则不需加上此参数 |
| -s   | 依序一个一个地执行fsck指令来检查                             |
| -A   | 对/etc/fstab中所有列出来的分区(partition)做检查              |
| -C   | 显示完整的检查进度                                           |
| -d   | 打印出 e2fsck 的 debug 结果                                  |
| -p   | 同时有 -A 条件时，同时有多个fsck的检查一起执行               |
| -R   | 同时有 -A 条件时，省略/不检查                                |
| -V   | 详细显示模式                                                 |
| -a   | 如果检查有错则自动修复                                       |
| -r   | 如果检查有错则由使用者回答是否修复                           |
| -y   | 选项指定检测每个文件是自动输入yes，在不确定那些是不正常的时候，可以执行 # fsck -y 全部检查修复 |

例：查看系统有多少文件系统支持的 fsck命令：

![image-20230413164642790](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413164642790.png)

例：强制检测 /dev/hdc6 分区：

![image-20230413164733709](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413164733709.png)

如果没有加上 -f 的选项，则由于这个文件系统不曾出现问题，检查的经过非常快速；若加上-f强制检查，才会一项一项的显示过程。



### du 检查磁盘空间使用量

语法：

```
df [-ahskm] <目录或文件名>
```

选项：

| 选项        | 说明                                                         |
| ----------- | ------------------------------------------------------------ |
| -a          | 列出所有的文件与目录容量，因为默认仅统计目录底下的文件量而已 |
| -h          | 以人们较易阅读的容量格式显示                                 |
| -s          | 列出总量而已，而不列出每个各别的目录占用容量                 |
| -S          | 不包括子目录下的总计，与-s有点差别                           |
| -b/-k/-m/-g | 以b/kb/mb/Gb为单位，显示目标占用磁盘块的总和                 |
| -x          | 以最初处理时的文件系统为准，跳过不同文件系统上的文件         |
| -D          | 显示指定符号链接的源文件大小                                 |

例：列出目前目录下的所有目录容量

![image-20230413160013437](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413160013437.png)

例：将文件的容量也列出来

![image-20230413160121990](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413160121990.png)

例：检查目录底下每个目录所占用的容量

![image-20230413160201769](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413160201769.png)

通配符 * 代表每个目录

与df不一样的是，du这个命令会直接到文件系统去搜寻所有的文件数据



### df 列出文件系统的整理磁盘使用量

语法：

```
df [-ahikHTm] <目录或文件名>
```

选项：

| 选项 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| -a   | 列出所有的文件系统，包含系统特有的/proc等文件系统            |
| -k   | 以KBytes的容量显示各文件系统                                 |
| -m   | 以MBytes的容量显示各文件系统                                 |
| -h   | 以人们较易阅读的GBytes、MBytes、KBytes等格式自行显示         |
| -H   | 以M=1000K取代M=1024K的进位方式                               |
| -T   | 显示文件系统类型，连同该partition的filesystem名称（例如ext3）也列出 |
| -i   | 不用硬盘容量，而以inode的数量来显示                          |

参数可以是文件，但打印的信息会是该文件所在文件系统磁盘的使用情况。

例：将系统内所有的文件系统列出来（默认1Kbytes）

![image-20230410161033002](Linux - 文件系统（原理&命令&编程）_imgs\image-20230410161033002.png)

例：将容量结果以易读的容量格式显示出来

![image-20230413155435691](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413155435691.png)

例：将系统内的所有特殊文件格式及名称都列出来

![image-20230413155538269](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413155538269.png)

### mkfs 磁盘格式化

语法：

```
mkfs [-t 文件系统格式] <装置文件名>
```

选项：-t：可以接文件系统格式，例如ext3、ext2、vfat等（系统有支持才会生效）

例：查看mkfs支持的文件格式

按下两个tab

![image-20230413161039812](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413161039812.png)

例：将分区/dev/hdc6 格式化为 ext3 文件系统

![image-20230413161127747](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413161127747.png)



### mkf2es

可为磁盘分区创建ext2、ext3文件系统

Mkfs命令也可以为磁盘分区创建系统，其常用选项为-t，参数一般为文件系统类型



### mount 磁盘挂载

将某个分区挂载到目录

语法：

```
mount [-t 文件系统] [-L Label名] [-o 额外选项] [-n] 装置文件名 挂载点
```

-t 指定待挂载设备的文件系统类型，常见的类型如下：

- 光盘/光盘镜像：iso9660
- DOS fat16文件系统：msdos
- Windows 9x fat32文件系统：ntfs
- Mount Windows 文件网络共享：smbfs
- UNIX(LINUX)文件网络共享：nfs

-o 描述设备的挂载方式，常用的挂载方式如下：

- loop：将一个文件视为硬盘分区挂载的系统
- ro：read-only，采用只读的方式挂载设备
- rw：采用读写的方式挂载设备
- iocharset：指定访问文件系统所用的字符集
- remount：重新挂载

例：用默认的方式，将刚刚创建的 /dev/hdc6 挂载到 /mnt/hdc6 上面

![image-20230413165040836](Linux - 文件系统（原理&命令&编程）_imgs\image-20230413165040836.png)



### unmount 磁盘卸除

当需要挂载的分区知识一个移动存储设备（如移动硬盘）时，要进行的工作是在该设备与主机之间进行文件传输，那么在文件传输完成后，需要卸下该分区。

语法：

```
umount [-fn] <装置文件名或挂载点>
```

选项：

- -f：强制卸除！可用在类似网络文件系统（NFS）无法读取到的情况下；
- -n：不升级 /etc/mtab 情况下卸除

unmount指定设备名或挂载点来接卸载分区，如挂载点目录为/mnt，使用的命令如下：

```
unmount /mnt
```

以设备为参数时，可能会因为设备正忙或无法响应导致挂载失败，也可以为命令添加选项-l，该选项代表“lazy mount"，使用该选项时，系统会立刻从文件层次结构中卸载指定的设备，但在空闲时才清除文件系统中的所有引用。

## 链接文件

### ln

第一个参数为被链接的文件，即源文件路径名，第二个参数为链接文件的路径名，指定链接文件的存储位置。

当ln命令的选项缺省时，系统会创建一个硬链接文件。

若搭配-s选项，则会创建一个软链接文件。

-i 交互模式，文件存在则提示用户是否覆盖。

-s 软链接(符号链接)。

-d 允许超级用户制作目录的硬链接。

-b 删除，覆盖以前建立的链接

注意：

- 创建硬链接文件时。源路径中的对象不能是一个目录，



## 路径操作

Linux的目录结构为树状结构，最顶级的目录为根目录/。

其他目录通过挂载可以将它们添加到树中，通过解除挂载可以移除它们。

绝对路径：由根目录/写起，例如 /usr/share/doc

相对路径：不是由/写起，例如由/usr/share/doc到/usr/share/man底下时，可以写成../man

### cd 切换路径

切换到相对路径

```
cd ./xxx
```

切换到绝对路径

```
cd /xxx
```

切换到当前用户的家目录

```
cd ~
```

去到上一级目录

```shell
cd ..
```

### mv 重命名文件和文件夹
mv a b
mv /a /b/c

### pwd 查看当前路径

-P 显示确实的路径，而非使用连结路径

### mkdir 创建路径

-m 配置文件的权限，不需要管默认权限

![image-20230327141618075](Linux - 文件系统（原理&命令&编程）_imgs\image-20230327141618075.png)

-p 帮助直接将所需要的目录（包含上一级目录）递归创建

![image-20230327141601131](Linux - 文件系统（原理&命令&编程）_imgs\image-20230327141601131.png)

### rmdir 删除目录

只能删除空的目录，rm可以删除非空目录

-p 连同上一级（空的）目录也一起删除

![image-20230327141741117](Linux - 文件系统（原理&命令&编程）_imgs\image-20230327141741117.png)

## 文件操作

### ls 查看文件

-a 查看包括隐藏文件在内的所有文件![image-20230323145108477](Linux - 文件系统（原理&命令&编程）_imgs\image-20230323145108477.png)

-l 以详细信息列出文件，包括文件的属性与权限等，可指定文件名

![image-20230323145224018](Linux - 文件系统（原理&命令&编程）_imgs\image-20230323145224018.png)

![image-20230323145300447](Linux - 文件系统（原理&命令&编程）_imgs\image-20230323145300447.png)

-d 仅列出目录本身，而不是列出目录内的文件数据

### cat 由第一行开始显示文件内容

语法：

```shell
cat [-AbEnTv]
```

选项与参数：

-A 相当于-vET的整合选项，可列出一些特殊字符而不是空白而已

-b 列出行号，仅针对非空白行做行号显示，空白行不标行号

-E 将结尾的断行字节$显示出来

-n 列印出行号，连同空白行也会有行号，与-b选项不同

-T 将[tab]按键以^l显示出来

-v 列出一些看不出来的特殊字符

### tac 从最后一行开始显示

### nl 显示的时候顺便输出行号

语法：

```shell
nl [-bnw] 文件
```

选项与参数：

-b 指定行号的指定方式，主要有两种：

-b a 表示不论是否为空行，也同样列出行号

-b t 如果有空行，空的那一行不要列出行号（默认）

-n 列出行号表示的方法，主要有三种

-n ln 行号在荧幕的最左方显示

-n rn 行号在自己栏位的最右方显示，且不加0

-n rz 行号在自己栏位的最右方显示，且加0

-w 行号栏位的占用位数

### more 分页显示文件内容

运行时可以输入的命令有：

f或Space 显示下一页

Enter 显示下一行

/字串 表示在这个显示的内容当中，向下搜寻’字串‘这个关键字

:f 立刻显示出档名以及目前显示的行数

q/Q 退出

b或[ctrl]-b 代表往回翻页，此动作只对文件有用，对管线无用

### less 与more相似，可以往前翻页

运行时可以输入的命令有：

Space 显示下一页

[pagedown] 向下翻动一页

[pageup] 向上翻动一页

/字串 向下搜寻’字串‘这个关键字

?字串 向上搜寻’字串‘这个关键字

n 重复前一个搜寻

N 反向的重复前一个搜寻

q/Q 退出

### head 查看文件的前n行

语法：

```shell
head [-n number] 文件
```

选项参数

-n 后面接数字，表示几行的意思

![image-20230323174303049](Linux - 文件系统（原理&命令&编程）_imgs\image-20230323174303049.png)

### tail 查看文件的后n行

语法：

```shell
head [-n number] 文件
```

选项参数

-n 后面接数字，表示几行的意思

-f 表示池逊检测后面所接的档名，按下Ctrl+C才会结束对tail的检测

![image-20230323174446751](Linux - 文件系统（原理&命令&编程）_imgs\image-20230323174446751.png)

### touch 创建新文件

## 文件路径操作

### cp 复制文件/目录

语法：

```shell
cp [-adfilprsu] <source> <destination>
cp [options] source1 source2 source3 ... directory
```

选项与参数：

-a 相当于-pdr

-d 若来源档为连结档的属性，则复制连结档属性而非文件本身

-f 强制，若目标文件已经存在且无法开始，则移除后再尝试一次

-i 若目标档已经存在时，在覆盖时会先询问动作的进行

-l 进行硬式连结的连结档创建，而非复制文件本身

-p 连同文件的属性一起复制过去，而非使用默认属性（备份常用）

-r 递归复制目录下的文件和子目录

-s 复制成为符号连结档，亦即”捷径“文件

-u 若destination比source旧才升级destintaion

### mv 移动文件或目录

语法：

```shell
cp [-adfilprsu] <source> <destination>
cp [options] source1 source2 source3 ... directory
```

选项与参数：

-f 忽略不存在的文件，不会出现警告信息

-r 递归删除目录中所有子文件和子目录，很危险

-i 在删除文件或目录时对要删除的内容逐一进行确认

### rm 删除目录中的文件或目录

-f 忽略不存在的文件，不会出现警告信息

-r 递归删除目录中所有子文件和子目录，很危险

-i 在删除文件或目录时对要删除的内容逐一进行确认

## 文件搜索

### which 查看命令所在路径

![image-20230323175613953](Linux - 文件系统（原理&命令&编程）_imgs\image-20230323175613953.png)

### find 接触搜索关键字查找文件或目录

find 搜索路径 [选项] 搜索关键字

-name 根据文件名查找

-size 根据文件大小查找

-user 根据文件所有者查找

### locate 借助搜索关键字查找文件或目录

locate [选项] 搜索关键字

locate速度远胜find

find搜索整个目录，locate搜索数据库 /var/lib/locatedb

即使文件存在，数据库中没有记录，locate便搜索不到

### grep 在文件中搜索与字符串匹配的行并输出

![image-20230323175911567](Linux - 文件系统（原理&命令&编程）_imgs\image-20230323175911567.png)



# 编程

![Linux - 编程 - 文件](Linux - 文件系统（原理&命令&编程）_imgs\Linux - 编程 - 文件.PNG)

![Linux - 编程 - 文件2](Linux - 文件系统（原理&命令&编程）_imgs\Linux - 编程 - 文件2.PNG)

![Linux - 编程 - 文件3](Linux - 文件系统（原理&命令&编程）_imgs\Linux - 编程 - 文件3.PNG)
